@model BookEditViewModel

@{
    ViewData["Title"] = "New Book";
}

<style>
    body {
        margin: 0;
        padding: 0;
        background-image: url('/images/PLM-HOME.png');
        background-size: cover;
        background-repeat: no-repeat;
        background-position: center;
        min-height: 100vh;
        display: block;
        justify-content: center;
        align-items: center;
    }

   .navbar-menu {
        display: flex;
        gap: 50px;
        align-items: center;
        position: absolute;
        top: 1.5em;
        z-index: 998;
        left: 51em;
        text-align: center;
        line-height: 22px;
        width: 3em
    }

    .navbar-menu a {
        text-decoration: none;
        color: #2e2c2b;
        font-family: 'MontserratSemiBold';
        font-size: 20px;
        font-weight: bold;
        transition: color 0.3s ease;
    }

    .navbar-menu .highlight {
        color: #DAA520;
        font-size: 24px;
        font-family: 'MontserratSemiBold';
    }

    .navbar-menu a:hover {
        color: #DAA520;
    }
    .edit-page {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
    }
    .edit-container {
        width: 100%;
        background-color: #ffffff;
        border-radius: 35px;
        padding: 20px;
        margin-top: 30px;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
        height: 75vh;
        border: 1px solid #a9a7a7;
        overflow: hidden;
    }

        .table.container {
            align-items: center;
            align-content: center;
        }


        /* Book Table Styling */
        .table {
            width: 100%;
            border-collapse: collapse;
            font-size: 24px;
            align-items: center;
        }

        .table th, .table td {
            text-align: left;
            font-weight: bold;
            font-family: 'TTNormsBold';
            vertical-align: middle;
            position: relative;
            align-items: center;
        }

        .new-book-icon {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            width: 40px;
            height: auto;
        }

        .filter-icon {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            width: 20px;
            height: auto;
        }

        .book-cover {
            width: 70px;
            height: auto;
            display: block;
            margin: 0 auto;
        }

        .return-button {
            display: inline-block;
            padding: 10px 18px;
            background-color: #4a73e5;
            color: white;
            border: none;
            border-radius: 24px;
            font-family: 'TT Fors Trial';
            font-weight: bold;
            cursor: pointer;
            text-align: center;
        }

        .borrowed {
            color: red;
        }

        .available {
            color: green;
        }

        .buttons {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            width: 40px;
            height: auto;
        }

        .styled-hr {
            border: none;
            border-top: 2px solid #ddd;
            width: 100%;
            margin: 20px 0;
        }

        .new-book-information {
            color: #b50a0a;
            font-family: 'PoppinsMedium';
            font-weight: 800;
        }

        /* Search Bar Styling */
        .input-container {
            display: flex;
            align-items: center;
            gap: 0px;
            max-width: 200px;
        }

        .input-bar {
            position: relative;
            width: 100%;
            font-family: 'PoppinsMedium', Arial, sans-serif;
        }

        .input-bar input[type="text"] {
            font-family: 'TTForsRegular';
            width: 48em;
            padding: 5px 5px 5px 20px;
            border: 1px solid gray;
            border-radius: 24px;
            font-size: 16px;
            font-weight: bold;
            color: black;
            outline: none;
            margin-left: -14em
        }

     /* Upload Button */
        .upload-btn {
            font-family: 'TTForsRegular', sans-serif;
            color: #4f68d9;
            background-color: #ffffff;
            font-size: 15px;
            padding: 5px;
            border: 1px solid gray;
            border-radius: 20px;
            cursor: pointer;
            width: 13em;
            margin-left: -21.3em;
            font-weight: 600;
            text-align: center;
        }
  
          .upload-btn:hover {
            background-color: #4f68d9;
            color: white
        }
          
          #imageUpload {
            display: none;
        }


        /* Submit Button */
        .submit-button-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100px;
            width: 100%;
        }

        .submit-button {
            display: inline-block;
            padding: 7px 12px;
            color: white;
            background-color: #4f68d9;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 16px;
            font-family: 'TTForsRegular';
            font-weight: bold;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.3);
            width: 12em;
        }
        .back-button {
            display: inline-block;
            padding: 7px 12px;
            color: white;
            background-color: #ff4444;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 16px;
            font-family: 'TTForsRegular';
            font-weight: bold;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.3);
            width: 12em;
            margin-right: 1em;
        }
  
        .submit-button:hover {
            background-color: #0056b3;
        }
        #confirmRfidButton, #rfidInputPopupField{
        cursor: default;
    }
    .popup-link {
        position: relative; /* Fixed to ensure it stays centered on screen */
        top: 46.5%; /* Center vertically */
        left: 48%; /* Center horizontally */
        transform: translate(-50%, -50%); /* Adjust position to truly center */
        background-color: white; /* Green background for success */
        color: black;
        padding: 15px 25px; /* Add padding for spacing */
        border-radius: 25px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        width: 20em;
        height: 22em;
        text-align: center; /* Center text within the popup */
        font-size: 20px;
        z-index: 1000;
    }
    .popup-link h2{
        color: #4f68d9;
        font-family: "PoppinsMedium";
        font-weight: 700;
    }
    .popup-link p {
        font-family: "TTForsRegular";
        font-weight: 300;
        font-size: 18px;
    }
    .rfid-image {
        width: auto;
        height: 13.5em;
        position: relative;
        margin-top: -4em;
    }
    #closeRfidPopupButton {
        position: absolute;
        bottom: 1%;
        left: 50%; /* Center horizontally */
        transform: translate(-50%, -50%);
        background-color: white ;
        color: #black;
        font-size: 15px;
        padding: 10px;
        border: 1px solid #4f68d9;
        border-radius: 20px;
        cursor: pointer;
        width: 10em;
        font-family: 'TTForsRegular', sans-serif;
    }
    #closeRfidPopupButton:hover {
        background-color: #4f68d9;
        color: #ffffff;
        font-size: 15px;
        padding: 10px;
        border: 1px solid #d5d7d6;
    }

    .linkcard-button {
        font-family: 'TTForsRegular', sans-serif;
        color: #4f68d9;
        background-color: #ffffff;
        font-size: 15px;
        padding: 5px;
        border: 1px solid gray;
        border-radius: 20px;
        cursor: pointer;
        width: 13em;
        margin-left: -21.3em;
        font-weight: 600;
    }
    .linkcard-button:hover{
        background-color: #4f68d9;
        color: white
    }
    .done-text {
        color: #13ab25;
    }

    .none-text {
        color: #b50a0a;
    }
    .table-contents {
        display: flex;
        flex-direction: row;
    }
    .table-right {
        display: flex;
        margin-left: 1em;
        align-items: start;
    }
    .popup-overlay {
        position: fixed;
        top: 53%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: rgba(0, 0, 0, 0.4);
        color: #13ab25;
        padding: 15px 25px;
        border-radius: 8px;
        font-family: "PoppinsMedium";
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        z-index: 999;
        transition: opacity 0.5s ease;
        width: 110%;
        height: 110%;
        text-align: center;
        font-size: 20px;
        font-weight: 400;
        display: none;
        backdrop-filter: blur(5px);
    }

    .popup-overlay.show {
        display: block;
        opacity: 1;
    }

    .popup-overlay.hide {
        opacity: 0;
    }
    .return-button {
        background-color: #4f68d9;
        color: white;
        padding: 5px;
        border-radius: 15px;
        font-family: 'PoppinsMedium';
        width: 6em;
    }
    .check-image {
        width: auto;
        height: 3em;
    }
    .error-image {
        width: 2em;
        height: 2em;
    }
    .popup-success {
        position: relative; /* Fixed to ensure it stays centered on screen */
        top: 50%; /* Center vertically */
        left: 50%; /* Center horizontally */
        transform: translate(-50%, -50%); /* Adjust position to truly center */
        background-color: white; /* Green background for success */
        color: #13ab25;
        padding: 15px 25px; /* Add padding for spacing */
        border-radius: 8px;
        font-family: "PoppinsMedium";
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        width: 19em;
        height: 6em;
        text-align: center; /* Center text within the popup */
        font-size: 20px;
        font-weight: 400;
        z-index: 1000;
    }
    .popup-error {
        position: relative; /* Fixed to ensure it stays centered on screen */
        top: 50%; /* Center vertically */
        left: 50%; /* Center horizontally */
        transform: translate(-50%, -50%); /* Adjust position to truly center */
        background-color: white; /* Green background for success */
        color: #b50a0a;
        padding: 15px 25px; /* Add padding for spacing */
        border-radius: 8px;
        font-family: "PoppinsMedium";
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        width: 19em;
        height: 6em;
        text-align: center; /* Center text within the popup */
        font-size: 20px;
        font-weight: 400;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: .5em;
        z-index: 1000;
    }
    </style>

    <body>
        <div class="navbar-menu">
            <a href="AdminPanel">HOME</a>
            <a href="AdminBookManagement" class="highlight">BOOK MANAGEMENT</a>
            <a href="AdminUserManagement">USER MANAGEMENT</a>
            <a href="AdminBookStat">BOOK STATISTICS</a>
        </div>

    <div class="edit-page">
        <div class="edit-container">
            <form method="post" asp-action="UpdateBook" asp-controller="Account" enctype="multipart/form-data">
                <!-- Hidden input for BookId -->
                <input type="hidden" asp-for="BookId" /> 

                <h1 class="new-book-information" align="center">Edit Book Information</h1>
                <hr class="styled-hr">
                <div class="table-contents">
                    <div class="bookCover">
                        <img src="@(Model.BookCoverUrl ?? "/path/to/default-image.jpg")" alt="Book Cover" style="width:250px; border-radius: 15px;">
                    </div>
                    <div class="table-right">
                        <table class="table">
                            <tbody>    
                                <tr>
                                    <td><strong>Title:</strong></td>
                                    <td>
                                        <div class="input-container">
                                            <div class="input-bar">
                                                <input asp-for="Title" placeholder="Title" required>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>Author:</strong></td>
                                    <td>
                                        <div class="input-container">
                                            <div class="input-bar">
                                                <input asp-for="Author" placeholder="Author" required>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td><strong>Publisher:</strong></td>
                                    <td>
                                        <div class="input-container">
                                            <div class="input-bar">
                                                <input asp-for="Publisher" placeholder="Publisher" required>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td><button type="button" class="back-button" onclick="window.location.href='@Url.Action("AdminBookManagement", "Account")'">Back</button><button type="submit" class="submit-button">Update Book</button></td>
                                </tr>
                            </tbody>
                        </table
                    </div>
                </div>
            </form>
        </div>
    </div>
        <div id="successPopup" class="popup-overlay" style="display: none;">
            <div class="popup-success">
                Book updated successfully!
                <img src="~/images/Check icon.png" class="check-image" alt="Check">
            </div>
        </div>

        <div id="errorPopup" class="popup-overlay" style="display: none;">
            <div class="popup-error">
                <span>@TempData["ErrorMessage"]</span>
                <img src="~/images/error-icon.png" class="error-image" alt="Error">
            </div>
        </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const showPopup = "@TempData["ShowPopup"]";
            
            if (showPopup === "Success") {
                displayPopup("successPopup", "/Account/AdminBookManagement");
            } else if (showPopup === "Error") {
                displayPopup("errorPopup");
            }
        });

        function displayPopup(popupId, redirectUrl = null) {
            const popup = document.getElementById(popupId);
            popup.style.display = "block";

            setTimeout(() => {
                popup.style.display = "none";
                if (redirectUrl) {
                    window.location.href = redirectUrl;
                }
            }, 2000);
        }
    </script>
</body>
